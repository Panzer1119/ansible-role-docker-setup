{# Loop over all the docker volume parent zfs datasets and create a section for each #}
{% for item in docker_volume_parent_zfs_dataset_names %}
# This is generated by Ansible
[{{ docker_zfs_pool_name }}/{{ docker_volume_plugin_zfs_dataset_name }}/{{ item }}]
	use_template = production
	recursive = zfs
{# If item contains "cache", do not keep a long history of snapshots #}
{% if "cache" in item %}
	frequently = 32
	hourly = 0
	daily = 0
	weekly = 0
	monthly = 0
	yearly = 0
{% endif %}

{% endfor %}
#############################
# templates below this line #
#############################

[template_production]
	frequently = 16
	hourly = 24
	daily = 7
	weekly = 4
	monthly = 12
	yearly = 10
	autosnap = yes
	autoprune = yes
	# This requires the modified version of Sanoid that supports the snapshot_name_format option
	snapshot_name_format = iso8601_basic
